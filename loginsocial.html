<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login Social - Portal SiqueiraX</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      background: url('https://i.imgur.com/eKjFtd1.png') no-repeat center center fixed;
      background-size: cover;
      display: flex; justify-content: center; align-items: center;
      color: white; margin:0;
    }
    .login-box {
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(10px);
      padding: 40px 30px;
      border-radius: 14px;
      box-shadow: 0 0 40px rgba(0, 0, 0, 0.7);
      text-align: center;
      width: 100%; max-width: 400px;
    }
    .login-box h1 {
      margin-bottom: 22px; font-size: 26px;
      color: #78aaff; text-shadow: 0 0 10px rgba(120,170,255,0.5);
    }
    .login-box input {
      width: 100%; padding: 14px; margin: 10px 0;
      border: none; border-radius: 10px;
      background: rgba(255,255,255,0.08);
      color:white; font-size: 15px;
    }
    .login-box button {
      width: 100%; padding: 14px;
      background: #5a88ff; border:none; border-radius:10px;
      font-size: 16px; color:white; cursor:pointer;
      margin-top: 14px; transition:0.3s;
    }
    .login-box button:hover { background:#3c6fff; }
    .alert-overlay {
      position:fixed; inset:0; background:rgba(0,0,0,0.78);
      display:none; justify-content:center; align-items:center; z-index:9999;
    }
    .alert-box {
      background:#1c1c1c; padding:30px; border-radius:14px;
      text-align:center; max-width:460px; width:90%; color:white;
      border:2px solid red; box-shadow:0 0 30px rgba(255,0,0,0.5);
    }
    .alert-box h2 { color:#ff4d4d; margin-bottom:12px; }
  </style>
</head>
<body>
  <div class="login-box">
    <h1>Portal Social</h1>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Nome de usuário" required />
      <input type="password" id="password" placeholder="Senha" required />
      <button type="submit">ENTRAR</button>
    </form>
  </div>

  <div class="alert-overlay" id="alertOverlay">
    <div class="alert-box">
      <h2>⛔ Acesso Negado</h2>
      <p id="alertMessage"></p>
    </div>
  </div>

  <script type="module">
    import { createClient } from 'https://esm.sh/@supabase/supabase-js'
    const supabase = createClient(
      'https://srgoshlhsgflszwviwcp.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyZ29zaGxoc2dmbHN6d3Zpd2NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxMDAzNTQsImV4cCI6MjA3NzQ2MDM1NH0.ge8ziu8qhxJiTd-Th8HWiN-L3S515g0y0WyDBt7T8lA'
    )

    const form = document.getElementById('loginForm')
    const alertOverlay = document.getElementById('alertOverlay')
    const alertMessage = document.getElementById('alertMessage')

    form.addEventListener('submit', async (e) => {
      e.preventDefault()
      const username = document.getElementById('username').value.trim()
      const password = document.getElementById('password').value

      const { data: user, error } = await supabase
        .from('usuarios')
        .select('*')
        .eq('username', username)
        .eq('password', password)
        .maybeSingle()

      if (error || !user) return showAlert("Usuário ou senha incorretos.")
      if (user.acesso_gamemodes !== 'permitido') return showAlert("⛔ Conta bloqueada.")

      // login ok
      sessionStorage.setItem("nomedeusuario", user.username)
      window.location.href = "portalsocial.html"
    })

    function showAlert(msg) {
      alertMessage.innerText = msg
      alertOverlay.style.display = "flex"
    }
  </script>
</body>
</html>
